## 테이블 모델링 시 SRP 고려하기

테이블을 모델링할 때도 SRP(단일 책임 원칙)를 고려하는 것이 모델링에 도움이 되는 것 같다.      
라이프 사이클 단위, 유스케이스 단위로 정규화를 생각해보는 것이다.   

예를 들어, 하나의 테이블에 여러 컬럼이 존재하는데, 함께 사용되지 않고 서로 다른 유스케이스에서만 사용되는 컬럼의 집합이 있을 수 있다.    

혹은, 테이블의 핵심 정보와 부수적인 정보가 섞여있는 경우도 있을 텐데, 이런 경우 테이블을 분리하는 것을 고민해 볼 수 있을 것 같다.  

### 예시 1: 서로 다른 유스케이스에서만 사용되는 컬럼들

예를 들어, '사용자' 테이블이 있다고 가정하면, 이 테이블에는 `이름`, `이메일`, `생성일자`와 같은 핵심 정보 외에도,   
사용자가 마지막으로 로그인한 시간(`마지막 로그인 시간`), 그리고 사용자의 선호 색상(`선호 색상`)과 같은 부수적인 정보가 들어 있을 수 있다. 

여기서 `마지막 로그인 시간`은 주로 사용자 인증과 관련된 유스케이스에서 사용되고,   
`선호 색상`은 사용자 프로필을 표시할 때 주로 사용된다고 할 때, 이 두 정보를 같은 테이블에 넣어야 할지 고민해볼 수 있다.   
이 경우, 로그인 관련 정보와 프로필 관련 정보를 책임을 나눠 각각 별도의 테이블로 분리할 수 있다.  

### 예시 2: 핵심 정보와 부수적인 정보의 분리

또 다른 예로, ‘상품’ 테이블이 있다고 가정하면,   
여기에는 `상품명`, `가격`과 같은 핵심 정보와 `상품 설명`, `상품 이미지` 같은 부수적인 정보가 함께 저장되어 있을 수 있다.   
만약 `상품명`, `가격`은 대부분의 비즈니스 로직에서 자주 사용되지만,   
`상품 설명`과 `상품 이미지`는 특정 페이지나 서비스에서만 사용된다면, 이 또한 테이블을 분리하는 것을 고려해볼 수 있다.  

### 균형의 중요성

다만, 지나치게 테이블을 세분화하면 조인이 많이 발생하고 성능에 영향을 줄 수 있기 때문에 **균형**이 중요한것 같다. 

개발 초기에는 요구사항이 자주 변할 수 있는데, 이때 미리 정규화를 해두면 오히려 모델을 자주 변경해야 하는 문제가 발생할 수 있다.   
따라서 DB 영역은 애플리케이션 영역에 비해 변경이 어렵기 때문에, 결정을 최대한 미루는 것이 좋다.  

### 도메인 모델과 영속 모델의 분리

이럴 때 애플리케이션 수준에서 **도메인 모델**과 **영속 모델**을 분리해 두면, 나중에 영속 계층만 교체할 수 있어 유연성을 확보할 수 있다.   
예를 들어, 개발 초기에는 영속 계층을 `HashMap` 같은 인메모리로 관리하다가,   
어느 정도 요구사항이 고정 되고나서 실제 데이터베이스를 이용한 모델로 전환한다면 큰 어려움 없이 작업할 수 있다.

### 유연한 초기 모델링

다만 인메모리 대신 꼭 데이터베이스를 사용해야 한다면,   
서비스 오픈 전인 초기 개발 단계에서는 테이블에 ID와 JSON으로 된 key-value 컬럼만 두는 방법으로, 요구사항 변경에 유연하게 대처할 수 있다.   

Product Table(key-value)
| id | value |
---- | ----
| 1 | {id: 1, name: 햇반, price: 1000}|

### 결론
결론적으로, 애플리케이션 설계 시 DB 중심의 설계가 되지 않도록 도메인 모델과 영속 모델을 분리해 두는 것이 바람직해 보인다.   

변경이 잦은 개발 초기에는 요구사항이 변경될 때마다 도메인 모델과 영속 모델을 모두 수정해야 하는 것이 번거로울 수는 있지만,  
이는 나중에 변경을 용이하게 만드는 트레이드오프라고 할 수 있다.   

가장 좋은 방법은 정말 필요할 때, 쓰이기 직전에 만드는 것이다.   
미리 만들어두면 나중에 상황이 달라져 계획한 대로 활용하지 못하는 경우가 많기 때문이다.  
  
